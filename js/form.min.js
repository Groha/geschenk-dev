import{a as E}from"./app.min.js";let c={getErrors(t){let a=0,l=t.querySelectorAll("[required]");return l.length&&l.forEach(s=>{(s.offsetParent!==null||s.tagName==="SELECT")&&!s.disabled&&(a+=this.validateInput(s))}),a},validateInput(t){let a=0;return t.type==="email"?(t.value=t.value.replace(" ",""),this.emailTest(t)?(this.addError(t),this.removeSuccess(t),a++):(this.removeError(t),this.addSuccess(t))):t.type==="checkbox"&&!t.checked?(this.addError(t),this.removeSuccess(t),a++):t.id==="phone"?(t.value=t.value.replace(/[^\d\s\-()+]/g,""),!t.value.trim()||!/^[\d\s\-()+]{3,14}$/.test(t.value)?(this.addError(t),this.removeSuccess(t),a++):(this.removeError(t),this.addSuccess(t))):t.id==="zip"?(t.value=t.value.replace(/[^\d]/g,""),/^\d{5}$/.test(t.value)?(this.removeError(t),this.addSuccess(t)):(this.addError(t),this.removeSuccess(t),a++)):t.value.trim()?(this.removeError(t),this.addSuccess(t)):(this.addError(t),this.removeSuccess(t),a++),a},addError(t){t.classList.add("--form-error"),t.parentElement.classList.add("--form-error");let a=t.parentElement.querySelector("[data-fls-form-error]");a&&t.parentElement.removeChild(a),t.dataset.flsFormErrtext&&t.parentElement.insertAdjacentHTML("beforeend",`<div data-fls-form-error>${t.dataset.flsFormErrtext}</div>`)},removeError(t){t.classList.remove("--form-error"),t.parentElement.classList.remove("--form-error"),t.parentElement.querySelector("[data-fls-form-error]")&&t.parentElement.removeChild(t.parentElement.querySelector("[data-fls-form-error]"))},addSuccess(t){t.classList.add("--form-success"),t.parentElement.classList.add("--form-success")},removeSuccess(t){t.classList.remove("--form-success"),t.parentElement.classList.remove("--form-success")},formClean(t){t.reset(),setTimeout(()=>{let a=t.querySelectorAll("input,textarea");for(let s=0;s<a.length;s++){const o=a[s];o.parentElement.classList.remove("--form-focus"),o.classList.remove("--form-focus"),c.removeError(o)}let l=t.querySelectorAll('input[type="checkbox"]');if(l.length&&l.forEach(s=>{s.checked=!1}),window.flsSelect){let s=t.querySelectorAll("select[data-fls-select]");s.length&&s.forEach(o=>{window.flsSelect.selectBuild(o)})}},0)},emailTest(t){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(t.value)}};function h(){function t(){const l=document.forms;if(l.length)for(const e of l)e.hasAttribute("data-fls-form-novalidate")||e.setAttribute("novalidate",!0),e.addEventListener("submit",function(r){const n=r.target;s(n,r)}),e.addEventListener("reset",function(r){const n=r.target;c.formClean(n)});async function s(e,r){if(c.getErrors(e)===0)if(e.dataset.flsForm==="ajax"){r.preventDefault();const i=e.getAttribute("action")?e.getAttribute("action").trim():"#",f=e.getAttribute("method")?e.getAttribute("method").trim():"GET",u=new FormData(e);e.classList.add("--sending");const d=await fetch(i,{method:f,body:u});if(d.ok){let v=await d.json();e.classList.remove("--sending"),o(e,v)}else e.classList.remove("--sending")}else e.dataset.flsForm==="dev"&&(r.preventDefault(),o(e));else if(r.preventDefault(),e.querySelector(".--form-error")&&e.hasAttribute("data-fls-form-gotoerr")){const i=e.dataset.flsFormGotoerr?e.dataset.flsFormGotoerr:".--form-error";E(i)}}function o(e,r=""){document.dispatchEvent(new CustomEvent("formSent",{detail:{form:e}})),setTimeout(()=>{if(window.flsPopup){const n=e.dataset.flsFormPopup;n&&window.flsPopup.open(n)}},0),c.formClean(e)}}function a(){document.body.addEventListener("focusin",function(l){const s=l.target;(s.tagName==="INPUT"||s.tagName==="TEXTAREA")&&(s.hasAttribute("data-fls-form-nofocus")||(s.classList.add("--form-focus"),s.parentElement.classList.add("--form-focus")),s.hasAttribute("data-fls-form-validatenow")&&c.removeError(s))}),document.body.addEventListener("focusout",function(l){const s=l.target;(s.tagName==="INPUT"||s.tagName==="TEXTAREA")&&(s.hasAttribute("data-fls-form-nofocus")||(s.classList.remove("--form-focus"),s.parentElement.classList.remove("--form-focus")),s.hasAttribute("data-fls-form-validatenow")&&c.validateInput(s))})}t(),a()}document.querySelector("[data-fls-form]")&&window.addEventListener("load",h);export{c as f};
